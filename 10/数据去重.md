> greenplum 数据去重

#### 查询重复数据

``` shell
select distinct id, count(*) from tableName group by id having count(*) > 1;
```

#### 查询要保留的数据

``` shell
select ctid, * from tableName where ctid in (select min(ctid) from tableName group by id);
```

#### 删除重复数据
``` shell
delete from tableName where ctid not in (select min(ctid) from tableName group by id)
``` 

#### greenplum 中删除重数据

``` shell
 DELETE FROM tableName USING 
(select gp_segment_id, ctid from 
(select gp_segment_id, ctid, rank() over (partition by name order by gp_segment_id, ctid) as rk from tableName ) foo 
WHERE rk <> 1) rows_to_delete 
WHERE tableName.gp_segment_id=rows_to_delete.gp_segment_id 
AND tableName.ctid=rows_to_delete.ctid;
```



